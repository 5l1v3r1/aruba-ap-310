#!/bin/sh
checksize()
{
	csz=`ls -l $1 | awk '{print $5}'` 
	if [ $csz -gt $2 ]; then
		echo "######################################################################################################################################"
		echo "######                                                                                                                           #####"
		echo ">>>      $1 size ($csz) exceeds limit ($2)       <<<"
		echo "######                                                                                                                           #####"
		echo "######################################################################################################################################"
		exit 1
	fi
	if [ $csz -eq 0 ]; then
		echo "######################################################################################################################################"
		echo "######                                                                                                                           #####"
		echo ">>>      $1 size ($csz) is zero; aborted         <<<"
		echo "######                                                                                                                           #####"
		echo "######################################################################################################################################"
		exit 1
	fi
}

file=$1
imginfo=$2
bfile=$(basename $file)

size=$(grep ^${bfile} $imginfo | awk '{print $5}')
if [ "$size" == "" ]; then
  echo Cannot find ${bfile} in $imginfo: not checking image size
else
  checksize $file $size
fi

