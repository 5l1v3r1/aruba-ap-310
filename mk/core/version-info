ARUBA_VERSION:=$(shell ${ARUBA_MK_SCRIPTS}/getversion ${SW_NAME})${BTAG}

ifdef FAT_AP
ARUBA_PLATFORM_VERSION:=$(shell echo ${ARUBA_VERSION} | sed 's/-\([0-9]*\.\)*[0-9]*\(-\)*\(.*\)/\2\3/')
endif

#
# LABELID is defined only for RE builds.
#
ifndef LABELID
VERSION:= $(USER)@$(P4CLIENT)-ENG.0000
IMAGE_NAME:=$(IMG)_$(ARUBA_VERSION)
ifdef FAT_AP
FINAL_VERSION:=${ARUBA_PLATFORM_VERSION}
else
FINAL_VERSION:=${ARUBA_VERSION}
endif
else
VERSION:= $(LABELID)
IMAGE_NAME:=$(IMG)_$(ARUBA_VERSION)_$(VERSION)
ifdef FAT_AP
FINAL_VERSION:=${ARUBA_PLATFORM_VERSION}_${VERSION}
else
FINAL_VERSION:=${ARUBA_VERSION}_${VERSION}
endif
endif

ifeq "$(filter ${TARGETS_WITH_NO_IMAGE_TYPE},$(MAKECMDGOALS))" ""
include ${ARUBA_MK_CORE}/aruba-image-type
include ${ARUBA_MK_PLATFORM_TYPES}/${ARUBA_PLATFORM_TYPE}/image-naming
endif
